var data,canvas,ctx,mouse_x,mouse_y,map_x=0,map_y=0,xhr=new XMLHttpRequest;function init(){canvas.width=document.body.clientWidth,canvas.height=document.body.clientHeight,ctx.translate(document.body.clientWidth/2,document.body.clientHeight/2),ctx.lineWidth=5,ctx.font="0.75rem sans-serif",ctx.textAlign="center"}function draw(){ctx.clearRect(canvas.width/2*-1,canvas.height/2*-1,canvas.width,canvas.height);var t=[];for(d1 in data)for(d2 in CompanyData=data[d1],ctx.fillStyle=CompanyData.color,ctx.strokeStyle=CompanyData.color,linesData=CompanyData.point,linesData){for(d3 in routeData=linesData[d2],ctx.beginPath(),ctx.moveTo(map_x+routeData[0].coord[0],map_y+routeData[0].coord[1]),routeData)pointData=routeData[d3],coord=pointData.coord,"station"in pointData&&(ctx.fillRect(map_x+coord[0]-10,map_y+coord[1]-10,20,20),t.push([pointData.station,map_x+coord[0],map_y+coord[1]-15])),Number(d3)<routeData.length-1&&(nextCoord=routeData[Number(d3)+1].coord,ctx.lineTo(map_x+nextCoord[0],map_y+nextCoord[1]));ctx.stroke()}for(d1 in ctx.fillStyle="#000",t)ctx.fillText(t[d1][0],t[d1][1],t[d1][2])}xhr.responseType="json",xhr.onload=function(){data=xhr.response,init(),draw()},xhr.open("GET","data.json"),xhr.send(),onload=(()=>{canvas=document.getElementById("main"),ctx=canvas.getContext("2d"),canvas.onmousedown=(t=>{mouse_x=t.offsetX,mouse_y=t.offsetY,canvas.onmousemove=(t=>{map_x+=t.offsetX-mouse_x,map_y+=t.offsetY-mouse_y,draw(),mouse_x=t.offsetX,mouse_y=t.offsetY})}),canvas.onmouseup=(()=>canvas.onmousemove=null)}),onresize=init;